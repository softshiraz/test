<script>
(function() {
    const canvas = document.createElement('canvas');
    canvas.style.position = 'fixed'; canvas.style.top = '0'; canvas.style.left = '0';
    canvas.style.pointerEvents = 'none'; canvas.style.zIndex = '-1';
    document.body.appendChild(canvas);
    
    const ctx = canvas.getContext('2d');
    let w, h, particles = [], N = 120, maxDist = 120;
    
    function resize() { w = canvas.width = innerWidth; h = canvas.height = innerHeight; }
    window.addEventListener('resize', resize);
    resize();
    
    function rand(a, b) { return Math.random() * (b - a) + a; }
    
    for (let i = 0; i < N; i++) {
        particles.push({
            x: rand(0, w), y: rand(0, h),
            vx: rand(-0.45, 0.45), vy: rand(-0.45, 0.45),
            r: rand(0.8, 2.2), a: rand(0.4, 0.95)
        });
    }
    
    function frame() {
        ctx.clearRect(0, 0, w, h);
        const isLight = document.body.classList.contains('light-mode');
        const color = isLight ? '74,144,226' : '255,215,0';
        
        for (let p of particles) {
            p.x += p.vx; p.y += p.vy;
            if (p.x < 0) p.x = w; if (p.x > w) p.x = 0;
            if (p.y < 0) p.y = h; if (p.y > h) p.y = 0;
            ctx.beginPath();
            ctx.fillStyle = `rgba(${color},${p.a * 0.9})`;
            ctx.arc(p.x, p.y, p.r, 0, 6.28);
            ctx.fill();
        }
        
        ctx.lineWidth = 0.7;
        for (let i = 0; i < particles.length; i++) {
            for (let j = i + 1; j < particles.length; j++) {
                const p = particles[i], q = particles[j];
                const d = Math.hypot(p.x - q.x, p.y - q.y);
                if (d < maxDist) {
                    ctx.beginPath();
                    ctx.strokeStyle = `rgba(${color},${(1 - d / maxDist) * 0.25})`;
                    ctx.moveTo(p.x, p.y); ctx.lineTo(q.x, q.y);
                    ctx.stroke();
                }
            }
        }
        requestAnimationFrame(frame);
    }
    frame();
})();
</script>
