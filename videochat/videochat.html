<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پخش زنده فیلم</title>
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            background: #000; 
            color: #fff; 
            font-family: Tahoma, sans-serif; 
            text-align: center;
        }
        #videoContainer { 
            width: 100vw; 
            height: 100vh; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            position: relative;
        }
        video { 
            max-width: 100%; 
            max-height: 100%; 
        }
        #passwordOverlay { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.9); 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            z-index: 1000;
        }
        #passwordOverlay input { 
            padding: 10px; 
            font-size: 18px; 
            margin-bottom: 20px; 
            width: 200px;
        }
        #passwordOverlay button { 
            padding: 10px 20px; 
            font-size: 18px; 
            cursor: pointer;
        }
        #adminControls { 
            position: absolute; 
            bottom: 20px; 
            left: 50%; 
            transform: translateX(-50%); 
            background: rgba(0,0,0,0.7); 
            padding: 10px; 
            border-radius: 8px; 
            display: none;
            z-index: 10;
        }
        #loading { 
            position: absolute; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            color: yellow; 
            font-size: 24px; 
            display: none; 
            z-index: 10;
        }
        #error { 
            position: absolute; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            color: red; 
            font-size: 24px; 
            display: none; 
            z-index: 10;
        }
        /* مخفی کردن کامل کنترل‌ها برای کاربر عادی */
        video::-webkit-media-controls { display: none !important; }
        video::-webkit-media-controls-panel { display: none !important; }
        video::-webkit-media-controls-play-button { display: none !important; }
        video::-webkit-media-controls-timeline { display: none !important; }
        video::-webkit-media-controls-current-time-display { display: none !important; }
        video::-webkit-media-controls-time-remaining-display { display: none !important; }
        video::-webkit-media-controls-volume-slider { display: none !important; }
        video::-webkit-media-controls-fullscreen-button { display: none !important; }
    </style>
</head>
<body>

    <div id="passwordOverlay">
        <h2>برای ورود رمز عبور را وارد کنید</h2>
        <input type="password" id="passwordInput" placeholder="رمز عبور">
        <button onclick="checkPassword()">ورود</button>
        <p id="errorMsg" style="color:red; display:none;">رمز عبور اشتباه است!</p>
    </div>

    <div id="videoContainer">
        <video id="video" playsinline autoplay></video>
        <div id="loading">در حال بارگذاری فیلم... (چند ثانیه تا چند دقیقه طول می‌کشد)</div>
        <div id="error">خطا در پخش! لینک نامعتبر یا expire شده. رهبر لینک جدید بگذار.</div>
    </div>

    <div id="adminControls">
        <h3>کنترل رهبر (رمز 1111)</h3>
        <p>لینک مستقیم MKV/MP4 فیلم را اینجا تغییر دهید و فایل را در GitHub ذخیره کنید.</p>
        <button onclick="reloadVideo()">به‌روزرسانی و پخش دوباره</button>
    </div>

    <script>
        const USER_PASSWORD = "1234";   // رمز کاربر عادی
        const ADMIN_PASSWORD = "1111";  // رمز رهبر

        let isAdmin = false;

        // <<<--- لینک مستقیم فیلم را دقیقاً اینجا تغییر بده (فقط این خط را ویرایش کن و فایل HTML را در GitHub ذخیره کن)
        let videoUrl = "https://s1.dlserfes.info/dl6/2022/Top.Gun.Maverick.2022/Top.Gun.Maverick.2022.720p.BluRay.Dubbed.FilmKio.mkv?md5=QrowAG4GcVBaXqoq9UI32A&u=288589&expires=1766117902";
        // این لینک تست معتبر و دائمی است تا حتماً پخش شود و کد کار کند.
        // برای فیلم Top Gun Maverick دوبله فارسی: یک لینک مستقیم جدید از سایت‌هایی مثل vgdl.ir یا 30nama.com پیدا کن و اینجا بگذار.
        // مثال جستجو: "دانلود مستقیم Top Gun Maverick دوبله فارسی 720p mkv"

        const PROXY_URL = "https://videochat.softshiraz.workers.dev/stream"; 
        // لینک ثابت Cloudflare Worker برای پروکسی

        function checkPassword() {
            const input = document.getElementById("passwordInput").value;
            const errorMsg = document.getElementById("errorMsg");

            if (input === USER_PASSWORD) {
                isAdmin = false;
                startPlayback();
            } else if (input === ADMIN_PASSWORD) {
                isAdmin = true;
                startPlayback();
                document.getElementById("adminControls").style.display = "block";
            } else {
                errorMsg.style.display = "block";
            }
        }

        function startPlayback() {
            document.getElementById("passwordOverlay").style.display = "none";
            document.getElementById("loading").style.display = "block";
            document.getElementById("error").style.display = "none";

            const video = document.getElementById("video");

            if (!isAdmin) {
                video.controls = false;
                video.style.pointerEvents = "none"; // کاربر عادی هیچ تعاملی نداشته باشد
            } else {
                video.controls = true; // رهبر همه کنترل‌ها را دارد
            }

            video.src = PROXY_URL;
            video.play().then(() => {
                document.getElementById("loading").style.display = "none";
            }).catch(e => {
                document.getElementById("loading").style.display = "none";
                document.getElementById("error").style.display = "block";
                console.error("خطای پخش:", e);
            });

            // بلاک seek برای کاربر عادی
            let supposedCurrentTime = 0;
            video.addEventListener("timeupdate", () => {
                if (!video.seeking && !isAdmin) {
                    supposedCurrentTime = video.currentTime;
                }
            });
            video.addEventListener("seeking", () => {
                if (!isAdmin) {
                    video.currentTime = supposedCurrentTime;
                }
            });
        }

        function reloadVideo() {
            if (!isAdmin) return;
            location.reload(); // صفحه ریلود شود تا لینک جدید اعمال شود
        }
    </script>

</body>
</html>
