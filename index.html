<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0">

    <!-- Open Graph (Ú¯Ø²ÛŒÙ†Ù‡ 36) -->
    <meta property="og:title" content="Ø³Ø§ÙØª Ø´ÛŒØ±Ø§Ø² - Ø§Ú©Ø±Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø®ØµÙˆØµÛŒ Ùˆ Ø§ÛŒÙˆÙ†Øªâ€ŒÙ‡Ø§ÛŒ Ø·Ù„Ø§ÛŒÛŒ">
    <meta property="og:description" content="Ø§Ú©Ø±Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø®ØµÙˆØµÛŒ ÙÛŒÙ„Ù… Ùˆ Ø§ÛŒÙˆÙ†Øªâ€ŒÙ‡Ø§ÛŒ Ø®Ø§Øµ Ø¯Ø± Ø´ÛŒØ±Ø§Ø²">
    <meta property="og:image" content="https://yourusername.github.io/your-repo/images/og-image.jpg">
    <meta property="og:url" content="https://yourusername.github.io/your-repo/">
    <meta property="og:type" content="website">

    <!-- Structured Data (Ú¯Ø²ÛŒÙ†Ù‡ 37) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "EventVenue",
      "name": "Ø³Ø§ÙØª Ø´ÛŒØ±Ø§Ø²",
      "url": "https://yourusername.github.io/your-repo/",
      "description": "Ø§Ú©Ø±Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø®ØµÙˆØµÛŒ Ùˆ Ø§ÛŒÙˆÙ†Øªâ€ŒÙ‡Ø§ÛŒ ÙØ±Ù‡Ù†Ú¯ÛŒ Ø¯Ø± Ø´ÛŒØ±Ø§Ø²"
    }
    </script>

    <title>Ø³Ø§ÙØª Ø´ÛŒØ±Ø§Ø²</title>

    <!-- ÙÙˆÙ†Øª Ùˆ Ø¢ÛŒÚ©ÙˆÙ† -->
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/dist/font-face.css?v=3" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css?v=3">

    <!-- PWA (Ú¯Ø²ÛŒÙ†Ù‡ 34) -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ffd700">

    <style>
        * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
        body {
            font-family: "Vazirmatn", sans-serif;
            background:#0e0e0f;
            color:#fff;
            overflow-x:hidden;
            position:relative;
            min-height:100vh;
        }

        /* Ù¾Ø§Ø±Ø§Ù„Ø§Ú©Ø³ Ù…Ù„Ø§ÛŒÙ… (Ú¯Ø²ÛŒÙ†Ù‡ 42) */
        body::before {
            content:''; position:fixed; inset:0; z-index:-3;
            background: radial-gradient(circle at 50% 50%, rgba(255,215,0,0.08) 0%, transparent 70%);
            pointer-events:none;
        }
        #particles-canvas { position:fixed; inset:0; z-index:-1; pointer-events:none; }

        /* Ù‡Ø¯Ø± */
        header {
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(10px);
            padding:15px 25px;
            display:flex; justify-content:space-between; align-items:center;
            border-bottom:1px solid rgba(48,48,48,0.5);
            position:sticky; top:0; z-index:20;
        }
        .logo-link { text-decoration:none; cursor:pointer; }
        .logo-fa {
            font-weight:700; font-size:26px;
            background:linear-gradient(45deg,#ffd700,#ffb300);
            -webkit-background-clip:text; color:transparent;
            transition:0.3s;
        }
        .logo-link:hover .logo-fa { text-shadow:0 0 20px rgba(255,215,0,0.8); transform:scale(1.05); }

        /* Ø¯Ú©Ù…Ù‡ Ù‡Ù…Ø¨Ø±Ú¯Ø± */
        .hamburger-btn {
            width:48px; height:42px; display:flex; align-items:center; justify-content:center;
            background:rgba(26,26,26,0.6); border-radius:10px; border:2px solid rgba(255,215,0,0.25);
            cursor:pointer; color:#ffd700;
        }
        .hamburger-inner { width:22px; height:16px; position:relative; }
        .hamburger-inner span { position:absolute; left:0; right:0; height:2px; background:#ffd700; border-radius:2px; }
        .hamburger-inner span:nth-child(1){ top:0; }
        .hamburger-inner span:nth-child(2){ top:7px; }
        .hamburger-inner span:nth-child(3){ top:14px; }

        /* Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ú¯Ø±ÛŒØ¯/Ù„ÛŒØ³Øª */
        .controls { display:flex; gap:12px; }
        .control-btn {
            width:42px; height:42px; border-radius:10px; background:rgba(26,26,26,0.6);
            border:2px solid rgba(255,215,0,0.25); color:#ffd700; display:flex;
            align-items:center; justify-content:center; cursor:pointer; transition:0.3s;
        }
        .control-btn.active, .control-btn:hover { background:#ffd700; color:#000; }

        /* ÙÛŒÙ„ØªØ±Ù‡Ø§ */
        .filters {
            max-width:1200px; margin:20px auto; padding:0 20px;
            display:flex; flex-wrap:wrap; gap:15px; justify-content:center; align-items:center;
        }
        .filters input, .filters select {
            padding:10px 15px; border-radius:10px; border:none;
            background:rgba(255,255,255,0.1); color:#fff; font-family:inherit;
        }
        .filters input::placeholder { color:rgba(255,255,255,0.6); }

        /* Ø¹Ù†ÙˆØ§Ù† Ø¨Ø®Ø´ */
        .section-title-wrapper { text-align:center; margin:40px 0 30px; }
        .section-title-box {
            display:inline-flex; background:rgba(255,215,0,0.1); backdrop-filter:blur(10px);
            border:2px solid #ffd700; border-radius:18px; padding:16px 50px;
            box-shadow:0 0 20px rgba(255,215,0,0.3); animation:glowPulse 4s ease-in-out infinite alternate;
        }
        .section-title-box h2 { color:#ffd700; font-size:32px; font-weight:900; letter-spacing:2px; }
        @keyframes glowPulse {
            from { box-shadow:0 0 20px rgba(255,215,0,0.3); }
            to { box-shadow:0 0 30px rgba(255,215,0,0.5); }
        }

        /* Ú¯Ø±ÛŒØ¯ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ */
        .movies-grid {
            display:grid; grid-template-columns:repeat(4,1fr); gap:25px;
            max-width:1200px; margin:0 auto 60px; padding:0 20px;
        }
        .movies-grid.list { grid-template-columns:1fr; }

        .movie-card {
            perspective:1200px; opacity:0; transform:translateY(50px);
            transition:opacity 0.8s ease, transform 0.8s ease; /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù† ÙˆØ±ÙˆØ¯ - Ú¯Ø²ÛŒÙ†Ù‡ 41 */
        }
        .movie-card.visible { opacity:1; transform:translateY(0); }

        .card-inner {
            position:relative; width:280px; height:420px; cursor:pointer;
            transition:transform 0.5s cubic-bezier(0.2,0.8,0.3,1); transform-style:preserve-3d;
        }
        .movies-grid.list .card-inner { width:100%; height:auto; display:flex; flex-direction:row; }

        /* Ø§ÙÚ©Øª hover Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ Ù‚ÙˆÛŒ (Ú¯Ø²ÛŒÙ†Ù‡ 45) */
        .movie-card:hover .card-inner {
            transform:translateZ(60px) rotateY(10deg) scale(1.1);
            box-shadow:0 30px 60px rgba(255,215,0,0.4);
        }

        .card-front, .card-back {
            position:absolute; inset:0; border-radius:16px; overflow:hidden;
            backface-visibility:hidden; border:2px solid rgba(255,215,0,0.65);
            box-shadow:0 0 8px rgba(255,215,0,0.25); background:rgba(19,19,20,0.85);
            backdrop-filter:blur(10px);
        }
        .card-back { transform:rotateY(180deg); padding:20px; text-align:right; font-size:14px; }
        .card-back h3 { color:#ffd700; }

        .img-bar { flex:1; overflow:hidden; }
        .img-bar img { width:100%; height:100%; object-fit:cover; transition:transform 0.4s; }
        .movie-card:hover .img-bar img { transform:scale(1.1); }

        .date-bar { height:52px; line-height:52px; text-align:center; background:rgba(0,0,0,0.5); color:#ffd700; font-size:19px; font-weight:900; }
        .title-bar { height:36px; line-height:36px; text-align:center; background:rgba(0,0,0,0.3); }
        .reserve-bar {
            height:36px; line-height:36px; text-align:center; background:#ffd700;
            color:#000; font-weight:bold; cursor:pointer;
        }
        .reserve-bar:hover { background:#ffea00; }

        /* Ú©Ø¯ ØªØ®ÙÛŒÙ (Ú¯Ø²ÛŒÙ†Ù‡ 54) */
        .discount-badge {
            position:absolute; top:10px; left:10px; z-index:5; background:#c0392b; color:#fff;
            padding:6px 12px; border-radius:8px; font-size:13px; font-weight:bold;
        }

        /* Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒ (Ú¯Ø²ÛŒÙ†Ù‡ 12) */
        .favorite-btn {
            position:absolute; top:10px; right:10px; z-index:5; width:40px; height:40px;
            border-radius:50%; background:rgba(0,0,0,0.6); display:flex;
            align-items:center; justify-content:center; cursor:pointer; font-size:18px;
        }
        .favorite-btn.active { color:#ffd700; }

        /* Ù…Ù†ÙˆÛŒ Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± */
        #side-menu {
            position:fixed; top:0; right:0; height:100vh; width:320px; max-width:85%;
            background:linear-gradient(180deg,rgba(12,12,12,0.98),rgba(20,20,20,0.98));
            box-shadow:4px 0 30px rgba(0,0,0,0.6); transform:translateX(100%);
            transition:transform 0.32s cubic-bezier(.2,.9,.2,1); z-index:30; padding:28px;
            display:flex; flex-direction:column; gap:18px; border-left:2px solid rgba(255,215,0,0.12);
        }
        #side-menu.open { transform:translateX(0); }
        #menu-close { align-self:flex-start; background:transparent; border:none; color:#ffd700; font-size:20px; cursor:pointer; }
        .side-links a {
            display:block; padding:12px 14px; border-radius:10px; text-decoration:none;
            color:#fff; background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.03);
        }
        .side-links a:hover { background:rgba(255,215,0,0.06); color:#ffd700; }

        /* Ø¨Ú©â€ŒØ¯Ø±Ø§Ù¾ Ù…Ù†Ùˆ */
        #menu-backdrop {
            position:fixed; inset:0; background:rgba(0,0,0,0.55); opacity:0;
            pointer-events:none; transition:opacity .28s; z-index:25;
        }
        #menu-backdrop.visible { opacity:1; pointer-events:auto; }

        /* Ù…ÙˆØ¯Ø§Ù„ Ø±Ø²Ø±Ùˆ (Ú¯Ø²ÛŒÙ†Ù‡ 11) */
        .modal {
            display:none; position:fixed; inset:0; background:rgba(0,0,0,0.85);
            z-index:100; align-items:center; justify-content:center;
        }
        .modal-content {
            background:#1a1a1a; padding:30px; border-radius:16px; width:90%; max-width:420px;
            border:2px solid #ffd700; text-align:center;
        }
        .modal input { width:100%; padding:12px; margin:10px 0; border-radius:10px; border:none; background:rgba(255,255,255,0.1); color:#fff; }
        .modal button {
            width:100%; padding:12px; margin:5px 0; border:none; border-radius:10px;
            background:#ffd700; color:#000; font-weight:bold; cursor:pointer;
        }

        /* Ù„ÙˆØ¯Ø± */
        #loading-overlay {
            position:fixed; inset:0; background:#111; display:flex;
            justify-content:center; align-items:center; z-index:10000; opacity:1;
            transition:opacity 0.9s ease;
        }
        #loading-overlay.hidden { opacity:0; pointer-events:none; }
        .loader { position:relative; width:40px; height:40px; }
        .loader .circle {
            position:absolute; width:38px; height:38px; opacity:0;
            transform:rotate(225deg); animation:orbit 5.5s infinite;
        }
        .loader .circle:after {
            content:''; position:absolute; width:5px; height:5px;
            border-radius:50%; background:yellow;
        }
        .loader .circle:nth-child(2) { animation-delay:240ms; }
        .loader .circle:nth-child(3) { animation-delay:480ms; }
        .loader .circle:nth-child(4) { animation-delay:720ms; }
        .loader .circle:nth-child(5) { animation-delay:960ms; }
        @keyframes orbit {
            0% { transform:rotate(225deg); opacity:1; }
            7% { transform:rotate(345deg); }
            30% { transform:rotate(455deg); }
            39% { transform:rotate(690deg); }
            70% { transform:rotate(815deg); opacity:1; }
            75% { transform:rotate(945deg); }
            76%,100% { opacity:0; }
        }

        @media (max-width:1200px) {.movies-grid{grid-template-columns:repeat(3,1fr);}}
        @media (max-width:768px) {.movies-grid{grid-template-columns:repeat(2,1fr);}}
        @media (max-width:480px) {.movies-grid{grid-template-columns:1fr;}}
    </style>
</head>
<body>

    <div id="loading-overlay">
        <div class="loader">
            <div class="circle"></div><div class="circle"></div><div class="circle"></div>
            <div class="circle"></div><div class="circle"></div>
        </div>
    </div>

    <canvas id="particles-canvas"></canvas>

    <header>
        <button class="hamburger-btn" id="hamburger" aria-label="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù…Ù†Ùˆ">
            <span class="hamburger-inner"><span></span><span></span><span></span></span>
        </button>
        <a href="index.html" class="logo-link"><div class="logo-fa">Soft Shiraz</div></a>
        <div class="controls">
            <button class="control-btn active" id="grid-view" title="Ú¯Ø±ÛŒØ¯"><i class="fas fa-th"></i></button>
            <button class="control-btn" id="list-view" title="Ù„ÛŒØ³Øª"><i class="fas fa-list"></i></button>
        </div>
    </header>

    <div id="menu-backdrop"></div>
    <nav id="side-menu">
        <button id="menu-close">Ã—</button>
        <div class="side-brand">Ø§ÛŒÙˆÙ†Øªâ€ŒÙ‡Ø§ÛŒ Ø·Ù„Ø§ÛŒÛŒ Ø³Ø§ÙØª Ø´ÛŒØ±Ø§Ø²</div>
        <div class="side-links">
            <a href="events/events.html">Ø§ÛŒÙˆÙ†Øªâ€ŒÙ‡Ø§ÛŒ Ú©ØªØ§Ø¨Ø®ÙˆØ§Ù†ÛŒ</a>
            <a href="pages/past-releases.html">Ø§Ú©Ø±Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø´Ø¯Ù‡â€ŒÙ‡Ø§</a>
            <a href="pages/venues.html">Ø³Ø§Ù„Ù†â€ŒÙ‡Ø§ÛŒ Ù‡Ù…Ú©Ø§Ø±</a> <!-- Ú¯Ø²ÛŒÙ†Ù‡ 24 -->
            <a href="pages/gallery.html">Ú¯Ø§Ù„Ø±ÛŒ Ø¹Ú©Ø³</a> <!-- Ú¯Ø²ÛŒÙ†Ù‡ 28 -->
            <a href="pages/about.html">Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§</a>
        </div>
        <div style="margin-top:auto; padding-top:20px; color:rgba(255,255,255,0.7); font-size:13px; text-align:right;">
            <div style="color:#ffd700; margin-bottom:8px;">Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§</div>
            <div id="sidebar-favorites">Ù‡ÛŒÚ† Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒâ€ŒØ§ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù†Ø´Ø¯Ù‡</div>
        </div>
        <div style="margin-top:20px; display:flex; justify-content:center; gap:18px;">
            <a class="menu-social-icon" href="https://t.me/softshiraz" target="_blank"><i class="fab fa-telegram"></i></a>
            <a class="menu-social-icon" href="https://instagram.com/soft_shiraz" target="_blank"><i class="fab fa-instagram"></i></a>
        </div>
    </nav>

    <div class="filters">
        <input type="text" id="search" placeholder="Ø¬Ø³ØªØ¬ÙˆÛŒ Ù†Ø§Ù… ÙÛŒÙ„Ù…...">
        <select id="genre-filter"><option value="">Ù‡Ù…Ù‡ Ú˜Ø§Ù†Ø±Ù‡Ø§</option></select>
        <select id="sort">
            <option value="soon">Ø¨Ù‡â€ŒØ²ÙˆØ¯ÛŒâ€ŒØªØ±ÛŒÙ†</option>
            <option value="name">Ù†Ø§Ù… Ø§Ù„ÙØ¨Ø§ÛŒÛŒ</option>
        </select>
    </div>

    <main>
        <section class="section-title-wrapper">
            <div class="section-title-box"><h2>Ø§Ú©Ø±Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø¢ÛŒÙ†Ø¯Ù‡</h2></div>
        </section>
        <div class="movies-grid" id="cards-container"></div>
    </main>

    <!-- Ù…ÙˆØ¯Ø§Ù„ Ø±Ø²Ø±Ùˆ -->
    <div class="modal" id="reserve-modal">
        <div class="modal-content">
            <h3>Ø±Ø²Ø±Ùˆ Ø¨Ù„ÛŒØ·</h3>
            <p id="modal-event-title" style="color:#ffd700; margin:10px 0;"></p>
            <input type="text" id="reserve-name" placeholder="Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ">
            <input type="number" id="reserve-count" placeholder="ØªØ¹Ø¯Ø§Ø¯ Ø¨Ù„ÛŒØ·" min="1" value="1">
            <input type="tel" id="reserve-phone" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)">
            <button id="send-reserve">Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù…</button>
            <button onclick="document.getElementById('reserve-modal').style.display='none'">Ø¨Ø³ØªÙ†</button>
        </div>
    </div>

    <script>
        // Ù„ÙˆØ¯Ø± Ûµ Ø«Ø§Ù†ÛŒÙ‡
        const overlay = document.getElementById('loading-overlay');
        const startTime = Date.now();
        window.addEventListener('load', () => {
            const elapsed = Date.now() - startTime;
            setTimeout(() => overlay.classList.add('hidden'), Math.max(0, 5000 - elapsed));
        });

        // Ù¾Ø§Ø±ØªÛŒÚ©Ù„ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ (Ú©Ø¯ Ø§ØµÙ„ÛŒ ØªÙˆ)
        (() => {
            const canvas = document.getElementById('particles-canvas');
            const ctx = canvas.getContext('2d');
            let w, h, particles = [], N = 120, maxDist = 120;
            function resize() { w = canvas.width = innerWidth; h = canvas.height = innerHeight; }
            addEventListener('resize', resize); resize();
            function rand(a,b) { return Math.random()*(b-a)+a; }
            function init() {
                particles = [];
                for(let i=0;i<N;i++){
                    particles.push({x:rand(0,w),y:rand(0,h),vx:rand(-0.45,0.45),vy:rand(-0.45,0.45),r:rand(0.8,2.2),a:rand(0.4,0.95)});
                }
            }
            function frame() {
                ctx.clearRect(0,0,w,h);
                for(let p of particles){
                    p.x += p.vx; p.y += p.vy;
                    if(p.x<0) p.x=w; if(p.x>w) p.x=0;
                    if(p.y<0) p.y=h; if(p.y>h) p.y=0;
                    ctx.beginPath(); ctx.fillStyle=`rgba(255,215,0,${p.a*0.9})`;
                    ctx.arc(p.x,p.y,p.r,0,6.28); ctx.fill();
                }
                ctx.lineWidth=0.7;
                for(let i=0;i<particles.length;i++){
                    for(let j=i+1;j<particles.length;j++){
                        const p=particles[i],q=particles[j];
                        const d=Math.hypot(p.x-q.x,p.y-q.y);
                        if(d<maxDist){
                            ctx.beginPath(); ctx.strokeStyle=`rgba(255,215,0,${(1-d/maxDist)*0.22})`;
                            ctx.moveTo(p.x,p.y); ctx.lineTo(q.x,q.y); ctx.stroke();
                        }
                    }
                }
                requestAnimationFrame(frame);
            }
            init(); frame();
        })();

        // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø§Ø² JSON
        let events = [], filteredEvents = [];
        async function loadData() {
            try {
                const res = await fetch('data.json?v='+Date.now());
                events = await res.json();
                filteredEvents = [...events];
                renderCards();
                populateGenreFilter();
            } catch(e) { console.error("Ø®Ø·Ø§ Ø¯Ø± Ù„ÙˆØ¯ data.json"); }
        }
        loadData();

        function renderCards() {
            const container = document.getElementById("cards-container");
            container.innerHTML = "";
            filteredEvents.forEach(event => {
                const card = document.createElement("div");
                card.className = "movie-card";
                card.innerHTML = `
                    <div class="card-inner">
                        ${event.discount ? `<div class="discount-badge">${event.discount}</div>` : ''}
                        <div class="favorite-btn" data-id="${event.id}"><i class="far fa-heart"></i></div>
                        <div class="card-front" data-admin-id="${event.adminId || 'softshirazadmin'}">
                            <div class="img-bar"><img src="${event.image}" loading="lazy" alt="${event.title}"></div>
                            <div class="date-bar"><strong>${event.date}</strong></div>
                            <div class="title-bar">${event.title}</div>
                            <div class="reserve-bar" data-id="${event.id}">ØªÙ‡ÛŒÙ‡ Ø¨Ù„ÛŒØ·</div>
                        </div>
                        <div class="card-back">
                            <h3>${event.title}</h3>
                            <p><strong>Ú˜Ø§Ù†Ø±:</strong> ${event.genre || 'Ù†Ø§Ù…Ø´Ø®Øµ'}</p>
                            <p>${event.description || 'Ø§Ú©Ø±Ø§Ù† Ø®ØµÙˆØµÛŒ Ø¨Ø§ Ø¨Ù‡ØªØ±ÛŒÙ† Ú©ÛŒÙÛŒØª'}</p>
                        </div>
                    </div>`;
                container.appendChild(card);
            });

            // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† ÙˆØ±ÙˆØ¯ Ù‡Ù†Ú¯Ø§Ù… Ø§Ø³Ú©Ø±ÙˆÙ„
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => { if(entry.isIntersecting) entry.target.classList.add("visible"); });
            }, {threshold:0.1});
            document.querySelectorAll('.movie-card').forEach(c => observer.observe(c));

            updateFavorites();
        }

        // ÙÛŒÙ„ØªØ± Ùˆ Ø¬Ø³ØªØ¬Ùˆ
        document.getElementById("search").addEventListener("input", filter);
        document.getElementById("genre-filter").addEventListener("change", filter);
        document.getElementById("sort").addEventListener("change", filter);

        function filter() {
            const query = document.getElementById("search").value.toLowerCase();
            const genre = document.getElementById("genre-filter").value;
            const sort = document.getElementById("sort").value;

            filteredEvents = events.filter(e =>
                (!query || e.title.toLowerCase().includes(query)) &&
                (!genre || e.genre === genre)
            );

            if(sort === "name") filteredEvents.sort((a,b) => a.title.localeCompare(b.title));
            if(sort === "soon") filteredEvents.sort((a,b) => new Date(a.date.split(' - ')[0].replace(/Û±Û´Û°Û´/g,'2025').replace(/\/\d+/g,m=>'/' + (parseInt(m.slice(1))+1))) - new Date(b.date.split(' - ')[0].replace(/Û±Û´Û°Û´/g,'2025').replace(/\/\d+/g,m=>'/' + (parseInt(m.slice(1))+1))));

            renderCards();
        }

        function populateGenreFilter() {
            const genres = [...new Set(events.map(e => e.genre).filter(Boolean))];
            const select = document.getElementById("genre-filter");
            genres.forEach(g => {
                const opt = document.createElement("option");
                opt.value = g; opt.textContent = g;
                select.appendChild(opt);
            });
        }

        // Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§
        function updateFavorites() {
            const favs = JSON.parse(localStorage.getItem("favorites") || "[]");
            document.querySelectorAll(".favorite-btn").forEach(btn => {
                const id = btn.dataset.id;
                btn.innerHTML = favs.includes(id) ? '<i class="fas fa-heart"></i>' : '<i class="far fa-heart"></i>';
                btn.onclick = () => {
                    if(favs.includes(id)) favs.splice(favs.indexOf(id),1);
                    else favs.push(id);
                    localStorage.setItem("favorites", JSON.stringify(favs));
                    updateFavorites();
                    updateSidebarFavorites();
                };
            });
            updateSidebarFavorites();
        }

        function updateSidebarFavorites() {
            const favs = JSON.parse(localStorage.getItem("favorites") || "[]");
            const container = document.getElementById("sidebar-favorites");
            if(favs.length===0){ container.textContent="Ù‡ÛŒÚ† Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒâ€ŒØ§ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù†Ø´Ø¯Ù‡"; return; }
            container.innerHTML = "";
            favs.forEach(id => {
                const ev = events.find(e => e.id === id);
                if(ev){
                    const a = document.createElement("a");
                    a.href = "#"; a.textContent = ev.title; a.style.display="block"; a.style.margin="6px 0"; a.style.color="#ffd700";
                    container.appendChild(a);
                }
            });
        }

        // Ú¯Ø±ÛŒØ¯/Ù„ÛŒØ³Øª
        document.getElementById("grid-view").onclick = () => {
            document.querySelector(".movies-grid").classList.remove("list");
            document.getElementById("grid-view").classList.add("active");
            document.getElementById("list-view").classList.remove("active");
        };
        document.getElementById("list-view").onclick = () => {
            document.querySelector(".movies-grid").classList.add("list");
            document.getElementById("list-view").classList.add("active");
            document.getElementById("grid-view").classList.remove("active");
        };

        // Ø±Ø²Ø±Ùˆ Ø¨Ø§ Ù…ÙˆØ¯Ø§Ù„
        let currentEvent = null;
        document.addEventListener("click", e => {
            const reserve = e.target.closest(".reserve-bar");
            if(reserve){
                currentEvent = events.find(ev => ev.id === reserve.dataset.id);
                if(currentEvent){
                    document.getElementById("modal-event-title").textContent = `${currentEvent.title} â€” ${currentEvent.date}`;
                    document.getElementById("reserve-modal").style.display = "flex";
                }
            }
        });

        document.getElementById("send-reserve").onclick = () => {
            if(!currentEvent) return;
            const name = document.getElementById("reserve-name").value.trim() || "Ù…Ø´ØªØ±ÛŒ";
            const count = document.getElementById("reserve-count").value || 1;
            const phone = document.getElementById("reserve-phone").value.trim();

            const message = `ğŸ’– Ø³Ù„Ø§Ù… ÙˆÙ‚Øª Ø¨Ø®ÛŒØ± ğŸ’–\n\nğŸ¬ ÙÛŒÙ„Ù…: ${currentEvent.title}\nğŸ•“ Ø²Ù…Ø§Ù†: ${currentEvent.date}\nğŸ‘¤ Ù†Ø§Ù…: ${name}\nğŸŸ ØªØ¹Ø¯Ø§Ø¯: ${count} Ù†ÙØ±\n${phone ? `ğŸ“ ØªÙ…Ø§Ø³: ${phone}\n` : ''}\nÙ…Ù…Ù†ÙˆÙ† Ù…ÛŒØ´Ù… Ø´Ø±Ø§ÛŒØ· Ø±Ø²Ø±Ùˆ Ø±Ùˆ Ø¨ÙØ±Ù…Ø§ÛŒÛŒØ¯ ğŸ™`;
            window.open(`https://t.me/${currentEvent.adminId || 'softshirazadmin'}?text=${encodeURIComponent(message)}`, "_blank");
            document.getElementById("reserve-modal").style.display = "none";
        };

        // ÙÙ„ÛŒÙ¾ Ú©Ø§Ø±Øª
        document.addEventListener("click", e => {
            if(e.target.closest(".reserve-bar") || e.target.closest(".favorite-btn")) return;
            const inner = e.target.closest(".card-inner");
            if(inner) inner.classList.toggle("flipped");
        });

        // Ù…Ù†ÙˆÛŒ Ù‡Ù…Ø¨Ø±Ú¯Ø±ÛŒ
        const hamburger = document.getElementById('hamburger');
        const sideMenu = document.getElementById('side-menu');
        const backdrop = document.getElementById('menu-backdrop');
        const menuClose = document.getElementById('menu-close');

        function openMenu() {
            sideMenu.classList.add('open');
            backdrop.classList.add('visible');
        }
        function closeMenu() {
            sideMenu.classList.remove('open');
            backdrop.classList.remove('visible');
        }

        hamburger.addEventListener('click', () => sideMenu.classList.contains('open') ? closeMenu() : openMenu());
        menuClose.addEventListener('click', closeMenu);
        backdrop.addEventListener('click', closeMenu);
        document.addEventListener('keydown', e => { if(e.key==='Escape') closeMenu(); });
    </script>
</body>
</html>
