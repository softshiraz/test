<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>سافت شیراز - اکران‌های آینده</title>

<link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/dist/font-face.css" rel="stylesheet">

<!-- Manifest -->
<link rel="manifest" href="/manifest.json" />

<!-- Font Awesome (برای آیکون پشتیبان در صورت نیاز) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
/* -------- پایه -------- */
* { margin:0; padding:0; box-sizing:border-box; }
html,body { height:100%; }
body {
    font-family: "Vazirmatn", sans-serif;
    background: linear-gradient(45deg,#0e0e0f,#1a1a1a,#0e0e0f);
    background-size:400% 400%;
    animation: gradientEffect 15s ease infinite;
    color:#fff;
    overflow-x:hidden;
    position:relative;
}

/* gradient حرکت */
@keyframes gradientEffect {
    0% { background-position:0% 50%; }
    50% { background-position:100% 50%; }
    100% { background-position:0% 50%; }
}

/* canvas / webgl overlay (pointer-events none so UI works) */
#webgl-overlay, #bokeh-canvas {
    position:fixed; inset:0; width:100%; height:100%; pointer-events:none; z-index:0;
}

/* ذرات طلایی (DOM fallback) */
#gold-particles { position: fixed; top:0; left:0; width:100%; height:100%; overflow:hidden; pointer-events:none; z-index:2; }

/* header */
header {
    background: rgba(0,0,0,0.45);
    backdrop-filter: blur(10px);
    padding:15px 25px;
    display:flex; justify-content:flex-end; align-items:center;
    border-bottom:1px solid rgba(48,48,48,0.5);
    position:sticky; top:0; z-index:10;
    text-shadow:0 0 10px rgba(255,215,0,0.25);
}
.logo-fa {
    font-weight:700;
    font-size:26px;
    background:linear-gradient(45deg,#ffd700,#ffb300);
    -webkit-background-clip:text;
    color:transparent;
}

/* main */
main { padding:35px 15px 60px; position:relative; z-index:5; }
h2 {
    color:#ffd700; font-size:28px; text-align:center;
    margin-bottom:35px; border-bottom:3px solid #ffd700;
    display:inline-block; padding-bottom:6px;
    text-shadow:0 0 8px rgba(255,215,0,0.3);
}

/* grid */
.section { text-align:center; }
.movies-grid {
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:20px;
    justify-items:center;
    max-width:1200px;
    margin:0 auto;
}

/* کارت (هولوگرافیک + نور) */
.movie-card { perspective:1200px; width:280px; }
.card-inner {
    position: relative;
    transition: transform 0.6s cubic-bezier(.2,.9,.2,1);
    transform-style: preserve-3d;
    cursor: pointer;
    width: 100%;
    height: 420px;
    border-radius:14px;
    transform-origin: center;
    will-change: transform;
    /* نور نرم و مرز طلایی ملایم */
    box-shadow: 0 8px 30px rgba(0,0,0,0.6), 0 0 18px rgba(255,215,0,0.03);
    border: 1px solid rgba(255,215,0,0.06);
    background: transparent;
}

/* جلو و پشت کارت */
.card-front, .card-back {
    position:absolute; inset:0;
    border-radius:14px;
    overflow:hidden;
    backface-visibility:hidden;
    background: rgba(19,19,20,0.55);
    backdrop-filter: blur(8px);
    border:1px solid rgba(34,34,34,0.45);
    display:flex; flex-direction:column;
}

.card-front { z-index:2; transform: translateZ(30px); }
.card-back { transform: rotateY(180deg); padding:18px; text-align:right; color:#fff; }

/* تصویر */
.img-bar { flex:1; width:100%; overflow:hidden; }
.img-bar img { width:100%; height:100%; object-fit:cover; display:block; }

/* عنوان / تاریخ / رزرو */
.date-bar, .title-bar, .reserve-bar {
    height:44px; line-height:44px;
    padding:0 12px; text-align:center;
    background: rgba(0,0,0,0.28);
    border-top:1px solid rgba(255,255,255,0.03);
    font-size:14px;
}
.date-bar { color:#ffd700; font-weight:700; text-shadow:0 0 6px rgba(255,215,0,0.15); }
.title-bar { color:#fff; font-weight:600; }
.reserve-bar { 
    color:#000; background:#ffd700; font-weight:800; cursor:pointer; user-select:none;
    display:flex; justify-content:center; align-items:center; gap:8px;
    border-bottom-left-radius:12px; border-bottom-right-radius:12px;
    position:relative; overflow:visible;
    /* پالس نرم */
    animation: pulseReserve 3s infinite;
    box-shadow: 0 6px 20px rgba(255,183,30,0.08), 0 0 18px rgba(255,215,0,0.08);
}
.reserve-bar .ring {
    position:absolute; inset: -8px -10px auto auto; width:20px; height:20px; border-radius:50%;
    background:rgba(255,255,255,0.06); transform:scale(.9); filter:blur(6px);
}

/* pulse */
@keyframes pulseReserve {
  0% { transform: translateY(0) scale(1); }
  50% { transform: translateY(-2px) scale(1.01); }
  100% { transform: translateY(0) scale(1); }
}

/* هولوگرافیک 버튼 */
.holo-btn {
  pointer-events:auto;
  background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
  border:1px solid rgba(255,255,255,0.06);
  padding:8px 14px;
  border-radius:10px;
  backdrop-filter: blur(6px);
  box-shadow: 0 6px 18px rgba(0,0,0,0.6), 0 0 18px rgba(255,215,0,0.03);
  transition: transform .2s ease, box-shadow .2s ease;
}
.holo-btn:hover { transform: translateY(-6px) rotateX(6deg); box-shadow: 0 16px 34px rgba(0,0,0,0.6); }

/* جلوه گلو (نرم) در المان‌های طلایی */
.golden-glow {
    text-shadow: 0 0 10px rgba(255,215,0,0.18), 0 0 30px rgba(255,215,0,0.08);
    box-shadow: 0 6px 20px rgba(255,183,30,0.03), inset 0 1px 0 rgba(255,255,255,0.02);
}

/* کارت پس‌زمینه محو نئون */
.movie-card::before {
    content:'';
    position:absolute; width:300px; height:440px; border-radius:20px;
    background: radial-gradient(circle, rgba(255,215,0,0.08), transparent 60%);
    filter:blur(22px); top:-10px; left:-10px; z-index:1; pointer-events:none;
}

/* card flip state */
.card-inner.flipped { transform: rotateY(180deg) translateZ(0); }

/* انیمیشن ظاهر شدن کارت‌ها (Fade + Slide up) */
.card-appear {
    opacity:0;
    transform: translateY(18px) scale(.99);
    transition: opacity .6s ease, transform .6s cubic-bezier(.2,.9,.2,1);
}
.card-appear.visible {
    opacity:1;
    transform: translateY(0) scale(1);
}

/* footer */
footer {
    background: rgba(0,0,0,0.45);
    backdrop-filter: blur(10px);
    padding:35px 20px; text-align:center;
    border-top:1px solid rgba(48,48,48,0.5);
    margin-top:60px;
    text-shadow: 0 0 10px rgba(255,215,0,0.25);
    position:relative; z-index:5;
}
.footer-title { font-size:18px; color:#ffd700; margin-bottom:18px; }
.social-row { display:flex; justify-content:center; gap:18px; align-items:center; }

/* آیکون‌های بامزه (استایل) */
.social-icon {
    width:56px; height:56px; border-radius:12px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    display:flex; align-items:center; justify-content:center;
    color:#ffd700; font-size:22px; text-decoration:none;
    border:1px solid rgba(255,215,0,0.06);
    transition: transform .18s ease, background .18s ease;
    pointer-events:auto;
}
.social-icon:hover { transform: translateY(-6px); background: rgba(255,215,0,0.08); color:#000; }

/* Popup about (مرکز صفحه) */
#about-overlay {
    position:fixed; inset:0; background: rgba(0,0,0,0.55); display:none; align-items:center; justify-content:center; z-index:1000;
}
#about-overlay.show { display:flex; }
#about-popup {
    width: min(720px, 94%);
    max-height: 88vh;
    overflow:auto;
    background: rgba(12,12,12,0.9);
    backdrop-filter: blur(12px);
    border-radius:14px;
    border:2px solid rgba(255,215,0,0.35);
    padding:20px; text-align:right; color:#fff;
    box-shadow: 0 20px 60px rgba(0,0,0,0.6);
    position:relative;
}
#about-popup .close-btn {
    position:absolute; left:16px; top:16px; background:transparent; color:#ffd700;
    border:1px solid rgba(255,215,0,0.12); padding:8px 10px; border-radius:10px; cursor:pointer;
}
#about-popup img { width:140px; height:140px; object-fit:cover; border-radius:12px; float:left; margin-left:18px; box-shadow: 0 10px 30px rgba(0,0,0,0.6); border:1px solid rgba(255,215,0,0.06); }
#about-popup h3 { color:#ffd700; margin-bottom:8px; }
#about-popup p { line-height:1.7; color:#ddd; }
#about-links { display:flex; gap:12px; margin-top:12px; flex-wrap:wrap; justify-content:flex-start; }

/* لودر orbit ساده */
#loading-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background:#111; display: flex; justify-content: center; align-items: center;
    z-index: 2000; opacity:1; transition:opacity .5s ease;
}
#loading-overlay.hidden { opacity:0; pointer-events:none; }

/* ریسپانسیو */
@media (max-width:1200px) { .movies-grid{grid-template-columns:repeat(3,1fr);} }
@media (max-width:768px)  { .movies-grid{grid-template-columns:repeat(2,1fr);} #about-popup img{display:none;} }
@media (max-width:480px)  { .movies-grid{grid-template-columns:1fr;} header{padding:12px;} .logo-fa{font-size:20px;} }
</style>
</head>
<body>

<!-- WebGL overlay (Three.js) -->
<canvas id="webgl-overlay"></canvas>
<canvas id="bokeh-canvas"></canvas>

<!-- ذرات طلایی DOM fallback -->
<div id="gold-particles"></div>

<!-- لودر -->
<div id="loading-overlay">
  <div class="loader" aria-hidden="true">
    <svg width="60" height="60" viewBox="0 0 100 100">
      <circle cx="50" cy="50" r="20" stroke="#ffd700" stroke-width="6" fill="none" stroke-linecap="round">
        <animate attributeName="stroke-dasharray" values="1,200;89,200;89,200" dur="1.8s" repeatCount="indefinite"/>
        <animateTransform attributeName="transform" type="rotate" from="0 50 50" to="360 50 50" dur="1.2s" repeatCount="indefinite"/>
      </circle>
    </svg>
  </div>
</div>

<header><div class="logo-fa">Soft Shiraz</div></header>

<main>
  <section class="section">
    <h2 class="golden-glow">اکران‌های آینده</h2>
    <div class="movies-grid" id="cards-container" aria-live="polite"></div>
  </section>
</main>

<footer>
  <div class="footer-title">شبکه‌های اجتماعی سافت شیراز</div>
  <div class="social-row">
    <!-- آیکون‌های بامزه: از SVG استفاده شده -->
    <a class="social-icon" href="https://t.me/softshiraz" target="_blank" rel="noopener" title="تلگرام">
      <!-- telegram playful svg -->
      <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M22 3L2 12.1l4.6 1.6L20.5 6.5 22 3z" fill="currentColor"/></svg>
    </a>

    <a class="social-icon" href="https://instagram.com/softshiraz" target="_blank" rel="noopener" title="اینستاگرام">
      <!-- instagram playful svg -->
      <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true"><rect x="3" y="3" width="18" height="18" rx="5" stroke="currentColor" stroke-width="1.5"/><circle cx="12" cy="12" r="3.2" stroke="currentColor" stroke-width="1.5"/></svg>
    </a>

    <button class="social-icon" id="about-btn" title="درباره ما"><i class="fas fa-info" aria-hidden="true"></i></button>
  </div>

  <!-- About popup overlay -->
  <div id="about-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div id="about-popup" role="document">
      <button class="close-btn" id="about-close">بستن</button>
      <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='320' height='320'><rect width='100%' height='100%' fill='%230b0b0b'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-size='26' fill='%23ffd700'>Soft Shiraz</text></svg>" alt="Soft Shiraz">
      <h3>دربارهٔ سافت شیراز</h3>
      <p>
        سافت شیراز مرجع معرفی فیلم‌های آینده و اخبار سینما است. ما با ترکیب طراحی سینمایی، نقد و معرفی فیلم و اطلاع‌رسانی اکران‌ها تلاش می‌کنیم تجربه‌ای لوکس و در عین حال کاربرپسند برای علاقه‌مندان سینما فراهم کنیم.
      </p>
      <p>
        تاریخچه: از سال ۱۴۰۰ با تمرکز بر رویدادهای سینمایی محلی شروع به کار کردیم و اکنون خبررسانی اکران‌های ایران و معرفی رویدادهای سینمایی را نیز پوشش می‌دهیم.
      </p>
      <div id="about-links">
        <a class="holo-btn" href="https://t.me/softshiraz" target="_blank" rel="noopener">تلگرام ما</a>
        <a class="holo-btn" href="https://instagram.com/softshiraz" target="_blank" rel="noopener">اینستاگرام</a>
        <a class="holo-btn" href="mailto:info@softshiraz.example">تماس</a>
      </div>
    </div>
  </div>
</footer>

<!-- اسکریپت‌های لازم -->
<script>
// ======================= PWA: register service worker =======================
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/service-worker.js').catch(function(err){
      console.warn('ServiceWorker registration failed: ', err);
    });
  });
}

// ======================= particles DOM fallback =======================
const particleContainer = document.getElementById("gold-particles");
for (let i = 0; i < 60; i++) {
    const p = document.createElement("div");
    p.className = "particle";
    const size = Math.random() * 3 + 2;
    p.style.width = size + "px";
    p.style.height = size + "px";
    p.style.left = Math.random() * 100 + "%";
    p.style.top = Math.random() * -100 + "vh";
    p.style.position = "absolute";
    p.style.background = "rgba(255,215,0,0.8)";
    p.style.borderRadius = "50%";
    p.style.boxShadow = "0 0 6px rgba(255,215,0,0.9)";
    p.style.animation = `floatDown ${Math.random()*4 + 4}s linear ${Math.random()*3}s infinite`;
    particleContainer.appendChild(p);
}
const styleEl = document.createElement('style');
styleEl.innerHTML = `
@keyframes floatDown {
    from { transform: translateY(-120vh); opacity:1; }
    to { transform: translateY(120vh); opacity:0; }
}
`;
document.head.appendChild(styleEl);

// ======================= loading overlay hide =======================
window.addEventListener('load', () => {
    setTimeout(() => {
        document.getElementById('loading-overlay').classList.add('hidden');
    }, 900); // کوتاه‌تر از قبل
});

// ======================= بارگذاری کارت‌ها (همان مسیر cards/*.html) =======================
const container = document.getElementById("cards-container");
let openCard = null;

async function loadCardsStrictly() {
    for (let num = 1; num <= 12; num++) {
        try {
            const response = await fetch(`cards/${num}.html`, { cache: "no-store" });
            if (!response.ok) continue;
            const html = await response.text();
            const cardWrapper = document.createElement("div");
            cardWrapper.className = "movie-card card-appear";
            cardWrapper.innerHTML = html;

            // اطمینان از وجود .card-inner در محتوای کارت؛ اگر موجود نیست، یک ساختار پیش‌فرض اضافه کن
            const inner = cardWrapper.querySelector('.card-inner');
            if (!inner) {
                // اگر فایل کارت ساده است، بساز
                const front = document.createElement('div');
                front.className = 'card-front';
                front.innerHTML = `
                    <div class="img-bar"><img src="https://picsum.photos/seed/${num}/640/480" alt="poster"></div>
                    <div class="date-bar golden-glow">تاریخ: نامعلوم</div>
                    <div class="title-bar">فیلم ${num}</div>
                    <div class="reserve-bar">رزرو بلیط<div class="ring"></div></div>
                `;
                const back = document.createElement('div');
                back.className = 'card-back';
                back.innerHTML = `<h3>جزئیات</h3><p>اطلاعات متنی فیلم ${num}.</p>`;
                const innerEl = document.createElement('div');
                innerEl.className = 'card-inner';
                innerEl.appendChild(front);
                innerEl.appendChild(back);
                cardWrapper.innerHTML = '';
                cardWrapper.appendChild(innerEl);
            }

            container.appendChild(cardWrapper);

            // جلوگیری از این که کلیک روی رزرو باعث flip شود
            const reserveButton = cardWrapper.querySelector(".reserve-bar");
            if (reserveButton) {
                reserveButton.addEventListener("click", (ev) => {
                    ev.stopPropagation(); // مهم: جلوی propagation رو می‌گیره تا کارت نچرخه
                    // انیمیشن تکان کوتاه برای بازخورد
                    reserveButton.animate([
                        { transform: 'scale(1)' },
                        { transform: 'scale(.96)' },
                        { transform: 'scale(1)' }
                    ], { duration: 260, easing: 'ease-out' });
                    // تغییر مسیر یا باز کردن تلگرام
                    window.open("https://t.me/softshiraz", "_blank");
                });
            }

            // Make card visible with animation (IntersectionObserver)
            observeAppearance(cardWrapper);

        } catch (e) {
            console.log("خطا در لود کارت", num, e);
        }
    }
}

function observeAppearance(el) {
    el.classList.remove('visible');
    if (!('IntersectionObserver' in window)) {
        el.classList.add('visible');
        return;
    }
    const io = new IntersectionObserver((entries, obs) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
                obs.unobserve(entry.target);
            }
        });
    }, { threshold: 0.12 });
    io.observe(el);
}

loadCardsStrictly();

// ======================= flip کارت ها (delegation) =======================
document.addEventListener("click", function (e) {
    const cardInner = e.target.closest(".card-inner");
    if (cardInner) {
        // اگر هدف داخل reserve-bar است، اجازه بده اون هندر بالا مدیریت کنه (reserve event stopPropagation کرده)
        if (e.target.closest('.reserve-bar')) return;
        if (openCard && openCard !== cardInner) openCard.classList.remove("flipped");
        cardInner.classList.toggle("flipped");
        openCard = cardInner.classList.contains("flipped") ? cardInner : null;
    }
});

// ======================= درباره ما popup =======================
const aboutBtn = document.getElementById("about-btn");
const aboutOverlay = document.getElementById("about-overlay");
const aboutClose = document.getElementById("about-close");
aboutBtn.addEventListener("click", (e) => {
    e.stopPropagation();
    aboutOverlay.classList.toggle('show');
    aboutOverlay.setAttribute('aria-hidden', aboutOverlay.classList.contains('show') ? 'false' : 'true');
});
aboutClose.addEventListener('click', ()=> { aboutOverlay.classList.remove('show'); aboutOverlay.setAttribute('aria-hidden','true'); });
aboutOverlay.addEventListener('click', (e) => {
    if (e.target === aboutOverlay) { aboutOverlay.classList.remove('show'); aboutOverlay.setAttribute('aria-hidden','true'); }
});

// ======================= Holographic UI: نور واکنشی به ماوس بر روی container =======================
const root = document.documentElement;
const cardsGrid = document.getElementById('cards-container');
document.addEventListener('mousemove', (e) => {
    // set css var (for potential per-card hover usage)
    root.style.setProperty('--mouse-x', `${e.clientX}px`);
    root.style.setProperty('--mouse-y', `${e.clientY}px`);
});

// هر کارت هنگام hover به نور واکنش نشان می‌دهد:
document.addEventListener('mouseover', (e) => {
    const card = e.target.closest('.movie-card');
    if (!card) return;
    const rect = card.getBoundingClientRect();
    card.querySelector('.card-inner')?.style.setProperty('transform', 'translateZ(6px)');
});
document.addEventListener('mouseout', (e) => {
    const card = e.target.closest('.movie-card');
    if (!card) return;
    card.querySelector('.card-inner')?.style.removeProperty('transform');
});

// ======================= Three.js ساده برای پس‌زمینه سینمایی (particles + نور طلایی واکنشی) =======================
// لود Three.js از CDN به صورت داینامیک
(function initThree() {
    const script = document.createElement('script');
    script.src = "https://cdn.jsdelivr.net/npm/three@0.156.0/build/three.min.js";
    script.onload = threeMain;
    script.onerror = ()=> console.warn('Three.js load failed — fallback canvas bokeh will be used.');
    document.head.appendChild(script);
})();

function threeMain() {
    try {
        const canvas = document.getElementById('webgl-overlay');
        const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true, antialias: true });
        renderer.setPixelRatio(window.devicePixelRatio);
        const w = innerWidth, h = innerHeight;
        renderer.setSize(w, h);

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(50, w / h, 0.1, 1000);
        camera.position.z = 20;

        // نور محیطی ملایم و یک نور طلایی
        const ambient = new THREE.AmbientLight(0xffffff, 0.25);
        scene.add(ambient);
        const point = new THREE.PointLight(0xffd27a, 1.2, 200);
        point.position.set(-10, 10, 20);
        scene.add(point);

        // ذرات (Points)
        const particleCount = 600;
        const geometry = new THREE.BufferGeometry();
        const positions = new Float32Array(particleCount * 3);
        const sizes = new Float32Array(particleCount);
        for (let i = 0; i < particleCount; i++) {
            positions[i*3+0] = (Math.random() - 0.5) * 80;
            positions[i*3+1] = (Math.random() - 0.6) * 40;
            positions[i*3+2] = (Math.random() - 0.5) * 40;
            sizes[i] = Math.random() * 3 + 0.5;
        }
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        geometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1));

        const mat = new THREE.PointsMaterial({ size: 1.8, color: 0xffd27a, transparent: true, opacity: 0.18 });
        const points = new THREE.Points(geometry, mat);
        scene.add(points);

        // واکنش به ماوس (نور طلایی دنبال‌رو)
        const mouse = new THREE.Vector2();
        window.addEventListener('mousemove', (e)=> {
            mouse.x = (e.clientX / innerWidth) * 2 - 1;
            mouse.y = -(e.clientY / innerHeight) * 2 + 1;
            point.position.x = mouse.x * 25;
            point.position.y = mouse.y * 12;
        });

        function onResize() {
            const w = innerWidth, h = innerHeight;
            renderer.setSize(w,h);
            camera.aspect = w/h;
            camera.updateProjectionMatrix();
        }
        window.addEventListener('resize', onResize);

        // انیمیشن
        const clock = new THREE.Clock();
        function animate() {
            requestAnimationFrame(animate);
            const t = clock.getElapsedTime();
            points.rotation.y = t * 0.02;
            points.rotation.x = Math.sin(t * 0.05) * 0.02;
            renderer.render(scene, camera);
        }
        animate();

    } catch (err) {
        console.error('Three main error', err);
    }
}

// ======================= بوهـــوک canvas ساده (در صورت عدم load three) =======================
(function bokehCanvas() {
    const canvas = document.getElementById('bokeh-canvas');
    const ctx = canvas.getContext('2d');
    function resize() { canvas.width = innerWidth; canvas.height = innerHeight; }
    resize(); window.addEventListener('resize', resize);
    const circles = Array.from({length: 20}, ()=> ({
        x: Math.random()*innerWidth, y: Math.random()*innerHeight,
        r: Math.random()*90+20, a: Math.random()*0.08+0.02, vy: Math.random()*0.2+0.05
    }));
    function draw() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        // کامپوزیت برای افکت
        circles.forEach(c=>{
            ctx.beginPath();
            ctx.fillStyle = `rgba(255,214,140,${c.a})`;
            ctx.shadowBlur = 40;
            ctx.shadowColor = 'rgba(255,215,0,0.08)';
            ctx.ellipse(c.x, c.y, c.r, c.r*0.6, 0, 0, Math.PI*2);
            ctx.fill();
            c.y -= c.vy;
            if (c.y < -100) { c.y = innerHeight + 120; c.x = Math.random()*innerWidth; }
        });
        requestAnimationFrame(draw);
    }
    draw();
})();

</script>
</body>
</html>
